---
# Main playbook to install Tailscale on all cloud VMs
- hosts: localhost
  connection: local

  pre_tasks:
    - name: Load vault vars explicitly
      include_vars:
        file: {{ playbook_dir }}/vars/example.yml
      no_log: true
  
  roles:
    - tailscale

  tasks:

    - name: Debug auth key loaded?
      debug:
        msg: "Auth key: {{ tailscale_auth_key | default('MISSING') }}"
        verbosity: 1  # Only shows with -v
  
    - name: Display completion message
      debug:
        msg: "Tailscale installation completed on {{ inventory_hostname }}"
